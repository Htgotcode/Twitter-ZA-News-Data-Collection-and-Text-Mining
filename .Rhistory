word =="#enca" |
word =="https" |
word =="#dstv403" |
word =="t.co" |
word =="rt" |
word =="amp"))
media_agency_df <- read_csv("data_in/media_agency_tweets.csv")
media_agency_df <- media_agency_df[ , colSums(is.na(media_agency_df)) < nrow(media_agency_df)]
#tidy df
tidy_covid_media_df <- media_agency_df %>%
#filter(str_detect(text, fixed(covid_dictionary, ignore_case = TRUE))) %>%
filter(!str_detect(text, "^RT")) %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text)) %>%
unnest_tokens(word, text, token = "tweets") %>%
filter(!word %in% stop_words$word,
!word %in% str_remove_all(stop_words$word, "'"),
str_detect(word, "[a-z]"),
!(word =="#sabcnews" |
word =="#enca" |
word =="https" |
word =="#dstv403" |
word =="t.co" |
word =="rt" |
word =="amp"))
media_agency_df %>% mutate(text = gsub("&amp", "", text),
text = gsub("(RT|via)((?:\\b\\W*@\\w+)+)", "", text),
text = gsub("@\\w+", "", text),
text = gsub("[[:punct:]]", "", text),
text = gsub("[[:digit:]]", "", text),
text = gsub("http\\w+", "", text),
text = gsub("[ \t]{2,}", "", text),
text = gsub("^\\s+|\\s+$", "", text),
text = gsub("&amp", "", text))
text = str_replace_all(clean_tweet,"@[a-z,A-Z]*"," ")
media_agency_df %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text),
text = gsub("&amp", "", text),
text = gsub("(RT|via)((?:\\b\\W*@\\w+)+)", "", text),
text = gsub("@\\w+", "", text),
text = gsub("[[:punct:]]", "", text),
text = gsub("[[:digit:]]", "", text),
text = gsub("http\\w+", "", text),
text = gsub("[ \t]{2,}", "", text),
text = gsub("^\\s+|\\s+$", "", text),
text = gsub("&amp", "", text)) %>%
mutate(text = str_replace_all(clean_tweet," "," "),
text = str_replace_all(clean_tweet,"RT @[a-z,A-Z]*: "," "),
text = str_replace_all(clean_tweet,"#[a-z,A-Z]*"," "),
text = str_replace_all(clean_tweet,"@[a-z,A-Z]*"," "))
media_agency_df %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text),
text = gsub("&amp", "", text),
text = gsub("(RT|via)((?:\\b\\W*@\\w+)+)", "", text),
text = gsub("@\\w+", "", text),
text = gsub("[[:punct:]]", "", text),
text = gsub("[[:digit:]]", "", text),
text = gsub("http\\w+", "", text),
text = gsub("[ \t]{2,}", "", text),
text = gsub("^\\s+|\\s+$", "", text),
text = gsub("&amp", "", text)) %>%
mutate(text = str_replace_all(text," "," "),
text = str_replace_all(text,"RT @[a-z,A-Z]*: "," "),
text = str_replace_all(text,"#[a-z,A-Z]*"," "),
text = str_replace_all(text,"@[a-z,A-Z]*"," "))
media_agency_df <- media_agency_df %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text),
text = gsub("&amp", "", text),
text = gsub("(RT|via)((?:\\b\\W*@\\w+)+)", "", text),
text = gsub("@\\w+", "", text),
text = gsub("[[:punct:]]", "", text),
text = gsub("[[:digit:]]", "", text),
text = gsub("http\\w+", "", text),
text = gsub("[ \t]{2,}", "", text),
text = gsub("^\\s+|\\s+$", "", text),
text = gsub("&amp", "", text)) %>%
mutate(text = str_replace_all(text," "," "),
text = str_replace_all(text,"RT @[a-z,A-Z]*: "," "),
text = str_replace_all(text,"#[a-z,A-Z]*"," "),
text = str_replace_all(text,"@[a-z,A-Z]*"," "))
#tidy df and unnest
tidy_covid_media_df <- media_agency_df %>%
#filter(str_detect(text, fixed(covid_dictionary, ignore_case = TRUE))) %>%
filter(!str_detect(text, "^RT")) %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text)) %>%
unnest_tokens(word, text, token = "tweets") %>%
filter(!word %in% stop_words$word,
!word %in% str_remove_all(stop_words$word, "'"),
str_detect(word, "[a-z]"),
!(word =="#sabcnews" |
word =="#enca" |
word =="https" |
word =="#dstv403" |
word =="t.co" |
word =="rt" |
word =="amp"))
#top words
top_words <- tidy_covid_media_df %>%
anti_join(stop_words) %>%
count(word) %>%
arrange(desc(n))
#top words
top_words <- tidy_covid_media_df %>%
anti_join(stop_words) %>%
count(word) %>%
arrange(desc(n))
top_words %>%
slice(1:20) %>%
ggplot(aes(reorder(word, -n), n, fill = word)) +
geom_bar(stat="identity") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size = 13),
plot.title = element_text(hjust = 0.5, size = 18)
) +
ylab("Frequency") +
xlab ("") +
ggtitle("Most frequent media agency tweets") +
guides(fill=FALSE)
vader_df <- vader_df(media_agency_df$text)
write_as_csv(vader_df, "data_in/vader_df")
View(vader_df)
top_words %>%
slice(1:20) %>%
ggplot(aes(reorder(word, -n), n, fill = word)) +
geom_bar(stat="identity") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size = 13),
plot.title = element_text(hjust = 0.5, size = 18)
) +
ylab("Frequency") +
xlab ("") +
ggtitle("Most frequent media agency tweets") +
guides(fill=FALSE)
#top words
top_words <- tidy_covid_media_df %>%
anti_join(stop_words) %>%
count(word) %>%
arrange(desc(n))
#tidy df and unnest
tidy_covid_media_df <- media_agency_df %>%
#filter(str_detect(text, fixed(covid_dictionary, ignore_case = TRUE))) %>%
filter(!str_detect(text, "^RT")) %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text)) %>%
unnest_tokens(word, text, token = "tweets") %>%
filter(!word %in% stop_words$word,
!word %in% str_remove_all(stop_words$word, "'"),
str_detect(word, "[a-z]"),
!(word =="#sabcnews" |
word =="#enca" |
word =="https" |
word =="#dstv403" |
word =="t.co" |
word =="rt" |
word =="amp"))
vader_df <- read_csv("data_in/vader_df.csv")
View(vader_df)
media_vader_df <- media_agency_df %>% left_join(vader_df)
View(media_vader_df)
write_as_csv(media_agency_df, "data_in/media_agency_df")
View(vader_df)
?vader_df
tidy_matrix <- tidy_covid_media_df %>% count(screen_name, word) %>% cast_dfm(screen_name, word, n)
media_lda <- LDA(tidy_matrix, k = 10, control = list(seed = 1234))
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
dia_lda <- LDA(tidy_matrix, k = 4, control = list(seed = 1234))
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
media_lda <- LDA(tidy_matrix, k = 4, control = list(seed = 1234))
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#JUST tidy
media_agency_df <- media_agency_df %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text),
text = gsub("&amp", "", text),
text = gsub("(RT|via)((?:\\b\\W*@\\w+)+)", "", text),
text = gsub("@\\w+", "", text),
text = gsub("[[:punct:]]", "", text),
text = gsub("[[:digit:]]", "", text),
text = gsub("http\\w+", "", text),
text = gsub("[ \t]{2,}", "", text),
text = gsub("^\\s+|\\s+$", "", text),
text = gsub("enca", "", text),
text = gsub("dstv", "", text),
text = gsub("sabcnews", "", text),
text = gsub("&amp", "", text)) %>%
mutate(text = str_replace_all(text," "," "),
text = str_replace_all(text,"RT @[a-z,A-Z]*: "," "),
text = str_replace_all(text,"#[a-z,A-Z]*"," "),
text = str_replace_all(text,"@[a-z,A-Z]*"," "))
#tidy df and unnest
tidy_covid_media_df <- media_agency_df %>%
#filter(str_detect(text, fixed(covid_dictionary, ignore_case = TRUE))) %>%
filter(!str_detect(text, "^RT")) %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text)) %>%
unnest_tokens(word, text, token = "tweets") %>%
filter(!word %in% stop_words$word,
!word %in% str_remove_all(stop_words$word, "'"),
str_detect(word, "[a-z]"),
!(word =="#sabcnews" |
word =="#enca" |
word =="https" |
word =="#dstv403" |
word =="t.co" |
word =="rt" |
word =="amp"))
tidy_matrix <- tidy_covid_media_df %>% count(screen_name, word) %>% cast_dfm(screen_name, word, n)
media_lda <- LDA(tidy_matrix, k = 4, control = list(seed = 1234))
media_lda <- LDA(tidy_matrix, k = 4, control = list(seed = 1234))
media_topics <- tidy(media_lda, matrix = "beta")
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
media_lda <- LDA(tidy_matrix, k = 4, control = list(seed = 1234))
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#tidy df and unnest
tidy_covid_media_df <- media_agency_df %>%
#filter(str_detect(text, fixed(covid_dictionary, ignore_case = TRUE))) %>%
filter(!str_detect(text, "^RT")) %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text)) %>%
unnest_tokens(word, text, token = "tweets") %>%
filter(!word %in% stop_words$word,
!word %in% str_remove_all(stop_words$word, "'"),
str_detect(word, "[a-z]"),
!(word =="sabcnews" |
word =="enca" |
word =="https" |
word =="dstv403" |
word =="dstv" |
word =="t.co" |
word =="rt" |
word =="amp"))
tidy_matrix <- tidy_covid_media_df %>% count(screen_name, word) %>% cast_dfm(screen_name, word, n)
media_lda <- LDA(tidy_matrix, k = 4, control = list(seed = 1234))
matrix
matrix
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
# rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
View(media_top_terms)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 1, "Vaccines" = 2, "idk" = 3, "Health in Africa" = 4)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = everything(), names_to = "topic", values_to = "beta")
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = "asd", names_to = "topic", values_to = "beta")
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = word, names_to = "topic", values_to = "beta")
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5)
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = term, names_to = "topic", values_to = "beta")
media_top_terms %>% pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = c(2,3,4,5), names_to = "topic", values_to = "beta")
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = c(2,3,4,5), names_to = "topic", values_to = "beta")
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = c(2,3,4,5), names_to = "topic", values_to = "beta") %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
pivot_longer(cols = c(2,3,4,5), names_to = "topic", values_to = "beta") %>%
drop_na() %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_lda <- LDA(tidy_matrix, k = 6, control = list(seed = 1234))
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
# pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
# rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
# pivot_longer(cols = c(2,3,4,5), names_to = "topic", values_to = "beta") %>%
# drop_na() %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
media_lda <- LDA(tidy_matrix, k = 5, control = list(seed = 1234))
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
# pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
# rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
# pivot_longer(cols = c(2,3,4,5), names_to = "topic", values_to = "beta") %>%
# drop_na() %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
#JUST tidy
media_agency_df <- media_agency_df %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text),
text = gsub("&amp", "", text),
text = gsub("(RT|via)((?:\\b\\W*@\\w+)+)", "", text),
text = gsub("@\\w+", "", text),
text = gsub("[[:punct:]]", "", text),
text = gsub("[[:digit:]]", "", text),
text = gsub("http\\w+", "", text),
text = gsub("[ \t]{2,}", "", text),
text = gsub("^\\s+|\\s+$", "", text),
text = gsub("enca", "", text),
text = gsub("dstv", "", text),
text = gsub("sabcnews", "", text),
text = gsub("covid", "", text),
text = gsub("&amp", "", text)) %>%
mutate(text = str_replace_all(text," "," "),
text = str_replace_all(text,"RT @[a-z,A-Z]*: "," "),
text = str_replace_all(text,"#[a-z,A-Z]*"," "),
text = str_replace_all(text,"@[a-z,A-Z]*"," "))
#tidy df and unnest
tidy_covid_media_df <- media_agency_df %>%
#filter(str_detect(text, fixed(covid_dictionary, ignore_case = TRUE))) %>%
filter(!str_detect(text, "^RT")) %>%
mutate(text = gsub(" ?(f|ht)tp(s?)://(.*)[.][a-z]+", "", text)) %>%
unnest_tokens(word, text, token = "tweets") %>%
filter(!word %in% stop_words$word,
!word %in% str_remove_all(stop_words$word, "'"),
str_detect(word, "[a-z]"),
!(word =="#sabcnews" |
word =="#enca" |
word =="https" |
word =="#dstv403" |
word =="t.co" |
word =="rt" |
word =="amp"))
tidy_matrix <- tidy_covid_media_df %>% count(screen_name, word) %>% cast_dfm(screen_name, word, n)
media_lda <- LDA(tidy_matrix, k = 5, control = list(seed = 1234))
media_topics <- tidy(media_lda, matrix = "beta")
media_top_terms <- media_topics %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
media_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
# pivot_wider(id_cols = term, names_from = topic, values_from = beta) %>%
# rename("Covid Spread in Gauteng" = 2, "Vaccines" = 3, "idk" = 4, "Health in Africa" = 5) %>%
# pivot_longer(cols = c(2,3,4,5), names_to = "topic", values_to = "beta") %>%
# drop_na() %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
sentimentr_df <- read_csv("data_in/sentimentr_data.csv")
View(sentimentr_df)
